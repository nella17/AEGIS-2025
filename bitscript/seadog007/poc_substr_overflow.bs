# POC 2: Substr Bounds Check Testing
#
# NOTE: The bounds check is working correctly!
# The check: start < 0 || start + length > string_length
#
# Test result:
# - substr("hello", 9223372036854775807, 1) â†’ CORRECTLY REJECTED
#   (start + length would exceed string length)
#
# The vulnerability exists in code logic (missing overflow check),
# but the bounds checks prevent exploitation.

# Create a test string
string s = "hello";

# This will be rejected: start (9223372036854775807) + length (1) > 5
# string sub = substr(s, 9223372036854775807, 1);  # Would be rejected

# Valid substr operations:
string sub1 = substr(s, 0, 5);  # Get entire string
print(sub1);

string sub2 = substr(s, 1, 3);  # Get "ell"
print(sub2);

string sub3 = substr(s, 0, 2);  # Get "he"
print(sub3);

# Test edge case: start at end of string
string sub4 = substr(s, 4, 1);  # Get "o"
print(sub4);

print("POC completed - bounds check working correctly");

